 grok {
         match => { "message" => "%{IP:SourceIP}" }
         add_field => { "SourceHost" => "%{SourceIP}" }
    }

    if [SourceIP] !~ "(^127\.0\.0\.1)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^192\.168\.)" and [SourceIP] {
       geoip {
         source => "SourceIP"
         remove_field => "SourceHost"
       }
    } else {
       dns {
           reverse => [ "SourceHost" ]
           action => "replace"
       }
   }
   
   
 
